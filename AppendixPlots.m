% Code to make figures in appendix, data brought over from RANS simulations
% utilised for "A data-informed analytic model for turbine power prediction 
% with anisotropic local blockage effects" M.C.R. Juniper & T. Nishino, 
% DOI: 10.1088/1742-6596/2265/2/022046.


%% PLOT 16
figure('DefaultAxesFontSize',19,'Position', [10 10 700 600])
hold on
kvals = [1,1.2,1.4,1.6,1.8,2,2.2,2.4,2.6,2.8,3,3.2,3.4,3.6,3.8,4,4.2,4.4,4.6,4.8,5,5.25,5.5,5.75,6,6.25,6.5,6.75,7];
cpall = [0.61504239, 0.67503267, 0.72359239, 0.76301886, 0.79509477, 0.82120855, 0.8424525, 0.85969585, 0.87363799, 0.88483721, 0.89375097, 0.90074634, 0.9061267, 0.91014183, 0.91300118, 0.91487662, 0.91591448, 0.91623508, 0.91594689, 0.91513828, 0.91388076, 0.91177434, 0.90917089, 0.90615923, 0.90281108, 0.89918603, 0.89533605, 0.89130486, 0.88712767];
CP_LMADT = [0.5930, 0.6465,0.6943,0.7352,0.7713,0.7981,0.8202,0.8386,0.8526,0.8667,0.8759,0.8845,0.8921,0.8986,0.9031,0.9080,0.9110,0.9134,0.9148,0.9164,0.9170,0.9175,0.9174,0.9168,0.9160,0.9149,0.9129,0.9111,0.9091];

kred = [1,2,3,4,5,6,7];
cpred = [0.5974,0.8030,0.8815,0.9099,0.9165,0.9130,0.9028];

ktmp = [1,2,3,4,5,6,7];
CPCircle = [0.59302,0.8019,0.88227,0.91112,0.91635,0.9102,0.89859];

plot(kvals,CP_LMADT)
plot(kvals,cpall)
%plot(ktmp,CPCircle)
plot(kred,cpred,'k*')

ylabel('$C_{P}^{*}$','Interpreter','latex')
xlabel('$K$','Interpreter','latex')
%legend('LMADT with uniform thrust','3D RANS','3D RANS Circle','LMADT with non-uniform thrust')
legend('LMADT with uniform thrust','3D RANS','LMADT with non-uniform thrust')

hline = findobj(gcf, 'type', 'line');
set(hline,'LineWidth',1.5)

exportgraphics(gcf,'C:/Users/Marcus/Downloads/Fig16.eps','Resolution',1200)
%% PLOT 14
figure('DefaultAxesFontSize',19,'Position', [10 10 700 600])
hold on
Ktmps = [1,2,3,4,5];
CpReg = [0.65907087 0.96284858 1.12370338 1.21527129 1.26898254];
CpMesh = [0.65913438 0.96310502 1.12424395 1.21612446 1.27016476];
plot(Ktmps,CpReg,'b-*','MarkerSize',8)
plot(Ktmps,CpReg,'r-.^','MarkerSize',12)

ylabel('$C_{P}^{*}$','Interpreter','latex')
xlabel('Resistance coefficient $K$','Interpreter','latex')
legend('Normal Mesh','High Resolution Mesh') 

hline = findobj(gcf, 'type', 'line');
set(hline,'LineWidth',2)

exportgraphics(gcf,'C:/Users/Marcus/Downloads/Fig14.eps','Resolution',1200)

%% PLOT 15

CtLoc = [1.07340351 1.07196783 1.17895329 1.23196058 1.06764874 1.18627359 ...
 1.23878459 1.22010113 1.26916806 1.0638565  1.19167776 1.24376881 ...
 1.27571537 1.22032537 1.25684016 1.30157415 1.06326006 1.19599158 ...
 1.24752012 1.28160941 1.30588284 1.25708636 1.28982899 1.32549551 ...
 1.06381438 1.19850152 1.25031118 1.28576985 1.31125898 1.32819226 ...
 1.26987644 1.2900373  1.31470331 1.34774541 1.1998891  1.25200341 ...
 1.28873018 1.31458419 1.33333351 1.34981154 1.30216934 1.31487627 ...
 1.3398749  1.35680353 1.25297287 1.29066921 1.31705546 1.33606496 ...
 1.35405182 1.36245039 1.32597818 1.34001929 1.35260111 1.36025484 ...
 1.29158367 1.31866747 1.33824464 1.35606929 1.3643534  1.36539574 ...
 1.34808824 1.3569746  1.36556754 1.31940597 1.33965077 1.35783406 ...
 1.36716524 1.3673787  1.37156562 1.35041184 1.36280033 1.36767449 ...
 1.34027608 1.35890384 1.36813023 1.36997419 1.37280896 1.37291759 ...
 1.3647992  1.35937936 1.36935073 1.37106594 1.37568938 1.37450623 ...
 1.36966257 1.3721847  1.37639989 1.37705887 1.37717148 1.37252762 ...
 1.37759493 1.37794258 1.37985215 1.37784702 1.37901794 1.38056501 ...
 1.38062727 1.37930546 1.38167631 1.38147745 1.38191976 1.38248625 ...
 1.38275336 1.06764874 1.0638565  1.07196783 1.19167776 1.06326006 ...
 1.19599158 1.07340351 1.18627359 1.24752012 1.06381438 1.19850152 ...
 1.25031118 1.07130286 1.17895329 1.24376881 1.28576985 1.1998891 ...
 1.25200341 1.28873018 1.06628976 1.16889586 1.23878459 1.28160941 ...
 1.31458419 1.25297287 1.29066921 1.31705546 1.06640831 1.15500958 ...
 1.23196049 1.27571546 1.31125898 1.33606496 1.29158367 1.31866747 ...
 1.33824464 1.0720975  1.15515978 1.22010113 1.26916796 1.30588284 ...
 1.33333351 1.35606929 1.31940597 1.33965077 1.35783406 1.07428539 ...
 1.16970578 1.22032537 1.25684016 1.30157387 1.32819226 1.35405182 ...
 1.36716524 1.34027608 1.35890384 1.36813023 1.07340387 1.17991713 ...
 1.23273775 1.25708636 1.2898288  1.32549551 1.34981154 1.3643534 ...
 1.36997437 1.35937936 1.36935073 1.37106594 1.06902777 1.18776845 ...
 1.23981569 1.26987644 1.29003739 1.31470331 1.34774541 1.36245039 ...
 1.3673787  1.37568938 1.36966257 1.3721847  1.37639989 1.0655881 ...
 1.19324704 1.24524447 1.27675287 1.30216934 1.31487627 1.3398749 ...
 1.35680353 1.36539574 1.37280887 1.37705887 1.37252762 1.37759493 ...
 1.37794258 1.06490789 1.19792278 1.24916118 1.28299828 1.30680907 ...
 1.32597818 1.34001929 1.35260111 1.36025484 1.37156562 1.37450623 ...
 1.37985215 1.37784675 1.37901794 1.38056501 1.06557689 1.20044811 ...
 1.25224045 1.28738857 1.31246662 1.32897744 1.34808824 1.3569746 ...
 1.36556727 1.37291759 1.37717148 1.38062727 1.37930546 1.38167631 ...
 1.38147745 1.06557689 1.2019607  1.25401577 1.29057764 1.31603728 ...
 1.33431414 1.35041184 1.36280033 1.36767449 1.37591011 1.37812809 ...
 1.3817961  1.38191976 1.38248625 1.38253885 1.06490789 1.2019607 ...
 1.25508939 1.2926424  1.31868717 1.33726647 1.35477016 1.36479902 ...
 1.37037293 1.37668408 1.37924992 1.3820631  1.38275336 1.38365098 ...
 1.38282888 1.0655881  1.20044811 1.25508939 1.29363796 1.32043085 ...
 1.3395725  1.35696108 1.36774382 1.37153466 1.37794663 1.37956001 ...
 1.3820631  1.38390692 1.38393352 1.38282888 1.06902777 1.19792278 ...
 1.25401577 1.29363796 1.32123323 1.34109807 1.35879465 1.36876418 ...
 1.37270447 1.37821229 1.37956001 1.3817961  1.38427256 1.38393352 ...
 1.38253885 1.07340387 1.19324704 1.25224045 1.2926424  1.32123333 ...
 1.34176657 1.35994908 1.37008637 1.37306934 1.37821229 1.37924992 ...
 1.38427256 1.38365098 1.07428539 1.18776845 1.24916127 1.29057764 ...
 1.32043085 1.34176657 1.3604488  1.37040182 1.37306934 1.37794663 ...
 1.37812809 1.38390692 1.0720975  1.17991713 1.24524447 1.28738857 ...
 1.31868717 1.34109807 1.3604488  1.37040182 1.37270447 1.37668408 ...
 1.06640831 1.16970578 1.23981569 1.28299828 1.31603746 1.3395725 ...
 1.35994908 1.37008655 1.37153493 1.37591011 1.06628976 1.15515978 ...
 1.23273775 1.27675306 1.31246662 1.33726665 1.35879465 1.36876418 ...
 1.37037311 1.07130286 1.15500958 1.30680907 1.33431414 1.35696108 ...
 1.36774382 1.1688961  1.32897744 1.35477016];

x = [25.56949043 21.26089287 25.31114769 28.9382515  16.74990845 21.03604889 ...
 24.93195343 32.69000626 28.33021545 12.07945728 16.56656837 20.70602036 ...
 24.37537193 35.99660492 32.05447769 27.43774223  7.29399204 11.94393158 ...
 16.29745674 20.22160721 23.55842209 35.24197388 31.12165451 26.12777138 ...
  2.43907261  7.21084023 11.74500847 15.90245819 19.51058578 22.35930634 ...
 37.85736465 34.13433075 29.75245667 24.2049942   2.41104841  7.08879089 ...
 11.45302773 15.32268047 18.46694756 20.59924507 36.43918991 32.50852966 ...
 27.74274826 23.39643097  2.36991477  6.90964603 11.02445793 14.47168064 ...
 16.93509865 19.83348274 34.35759735 30.12217712 26.93788147 24.02190018 ...
  2.30953836  6.64669847 10.39540482 13.22258568 16.25230789 20.35786629 ...
 31.30223465 27.66728783 24.55774879  2.22091842  6.26074362  9.47208118 ...
 12.65619755 16.67803001 20.80641747 32.32481003 28.29329681 25.00343895 ...
  2.09084177  5.69423962  9.04845619 12.98524475 17.04170418 21.17867279 ...
 28.81528282  1.8999157   5.43240118  9.2823782  13.26603222 17.34295654 ...
  1.81135476  5.57230806  9.48183155 13.49827194 17.58147621  1.857916 ...
  5.691535    9.64660644 13.68171883  1.89758396  5.78995609  9.77653217 ...
 13.81617832  1.93031693  5.8674674   9.87146664  1.9560802   5.92398596 ...
  1.97484589 16.74990845 12.07945728 21.26089478 16.56656647  7.29399157 ...
 11.94393253 25.56949043 21.03604889 16.29745674  2.43907261  7.2108407 ...
 11.74500847 29.63472557 25.31114769 20.70602036 15.90245819  2.41104841 ...
  7.08879089 11.45302677 33.41796875 29.35250092 24.93195343 20.22160721 ...
 15.32267952  2.36991477  6.90964651 11.02445889 36.86099625 33.12298584 ...
 28.9382515  24.37537193 19.51058578 14.47168064  2.30953836  6.64669847 ...
 10.39540482 39.93027496 36.51072693 32.69000626 28.33021545 23.55842209 ...
 18.46694946 13.22258568  2.22091842  6.26074362  9.47208118 42.61797333 ...
 39.48180771 35.99660492 32.05447769 27.43774223 22.35930634 16.93510056 ...
 12.65634155  2.09084177  5.69423914  9.04857445 44.89830399 42.08295822 ...
 38.82355118 35.24197388 31.12165642 26.12776947 20.59924316 16.25246048 ...
 12.98560047  1.8999157   5.43247843  9.28267002 46.74939728 44.28946686 ...
 41.29766464 37.85736084 34.13432693 29.75245667 24.2049942  19.83362198 ...
 16.67840576 13.26646328  1.81138194  5.57249975  9.48218441 48.15348053 ...
 46.08037567 43.3958168  40.14500809 36.43918991 32.50852966 27.74275017 ...
 23.39653397 20.35821152 17.04215813 13.49867439  1.85798311  5.69176722 ...
  9.64693737 49.09709167 47.43866348 45.09839249 42.08411407 38.45314407 ...
 34.35759354 30.12217712 26.93791962 24.02215385 20.80682945 17.34337807 ...
 13.68202782  1.89766526  5.79017448  9.77678776 49.57117462 48.35142899 ...
 46.38946152 43.65703201 40.15880203 35.96982574 31.30223465 27.66738319 ...
 24.55805206 21.17905617 17.58179855 13.8163681   1.9303937   5.86763763 ...
  9.87162495 49.57117081 48.80998993 47.25695038 44.84943771 41.54140472 ...
 37.33282089 32.32480621 28.29341125 25.00371742 21.47454834 17.75720787 ...
 13.90158463  1.95614016  5.92409182  9.9313755  49.09709167 48.80998993 ...
 47.69272614 45.6504631  42.58899307 38.43609238 33.18485641 28.81538773 ...
 25.3587265  21.69303322 17.86945724 13.93762207  1.97488356  5.95949459 ...
  9.95600128 48.15348434 48.35142899 47.69272995 46.05281067 43.29247284 ...
 39.27111435 33.87811661 29.23280144 25.62274742 21.8343277  17.91846657 ...
 13.93760777  1.9866097   5.97382307  9.95598793 46.74939346 47.4386673 ...
 47.25694656 46.05281067 43.64574432 39.83141327 34.40113068 29.54524803 ...
 25.79553604 21.89831161 17.91845131 13.90150738  1.99131155  5.97381353 ...
  9.93130779 44.8983078  46.08037567 46.38946152 45.6504631  43.64574814 ...
 40.11265564 34.75127411 29.75242233 25.87693787 21.89830017 17.86937904 ...
  1.99130797  5.95944834 42.61797714 44.28946686 45.09838867 44.84943771 ...
 43.29247284 40.11265564 34.92678452 29.85412407 25.87692833 21.83425903 ...
 17.75701332  1.98659313 39.93027496 42.08295822 43.3958168  43.65703201 ...
 42.58899307 39.83141327 34.92678452 29.85412216 25.79548836 21.69286156 ...
 36.86099625 39.48180771 41.29766464 42.08411407 41.54140854 39.27111435 ...
 34.75127411 29.75240517 25.62262535 21.47425652 33.41796875 36.51072693 ...
 38.82355118 40.14500809 40.15879822 38.43609619 34.40113068 29.54520226 ...
 25.3585186  29.63472557 33.12298203 38.45314407 37.33282471 33.87812042 ...
 29.23272514 29.35250092 35.96982193 33.18485641];

y = [142.6179657  144.8983154  142.082962   138.8235474  146.7494049 ...
 144.2894592  141.2976532  135.9965973  137.8573608  148.1534729 ...
 146.0803833  143.395813   140.1450043  132.6900024  135.2419739 ...
 136.4391937  149.0970917  147.4386597  145.0983887  142.0841064 ...
 138.4531403  132.0544739  134.1343231  134.3575897  149.571167 ...
 148.3514252  146.3894653  143.6570435  140.1587982  135.9698334 ...
 128.3302155  131.1216583  132.5085297  131.3022308  148.8099823 ...
 147.2569427  144.8494415  141.5413971  137.3328247  132.3248138 ...
 127.4377365  129.7524567  130.1221771  127.6673813  147.6927338 ...
 145.6504669  142.5889893  138.4360962  133.1848602  128.2934113 ...
 126.1277695  127.7427444  126.9379196  124.0221558  146.0528107 ...
 143.2924805  139.2711182  133.8781281  128.8153839  124.5580521 ...
 124.2049942  123.3965302  120.3582077  143.645752   139.8314056 ...
 134.4011383  129.2328033  125.0037155  120.8068314  120.5992432 ...
 119.8336182  116.6784134  140.1126556  134.7512817  129.5452576 ...
 125.3587265  121.1790543  117.04216    116.2524567  134.9267883 ...
 129.7524261  125.6227417  121.4745483  117.3433762  129.854126 ...
 125.7955399  121.6930389  117.5818024  113.4986725  125.8769379 ...
 121.8343277  117.7572098  113.6820297  121.8983154  117.8694611 ...
 113.8163681  109.7767868  117.9184723  113.9015884  109.8716202 ...
 113.9376297  109.9313736  109.9560013   53.25060272  51.84651947 ...
  55.10169601  53.91962051  50.90290833  52.5613327   57.38202667 ...
  55.71052933  54.90161133  50.42882919  51.6485672   53.61053848 ...
  60.06972122  57.91703796  56.6041832   56.34296799  51.19001007 ...
  52.74305344  55.15056229  63.13900375  60.51818848  58.70233536 ...
  57.91588593  58.45859528  52.30727386  54.34953308  57.41100693 ...
  66.58203125  63.48927307  61.17644882  59.85499191  59.84119797 ...
  61.56390762  53.94718552  56.70752716  60.72888947  70.36527252 ...
  66.87702179  64.00339508  62.14263535  61.54685593  62.66717529 ...
  66.12187958  56.35425568  60.16858673  65.59886932  74.43051147 ...
  70.64749908  67.30999756  64.75802612  63.56081009  64.03017426 ...
  66.81513977  70.76727295  59.88734436  65.24873352  70.45479584 ...
  78.73910522  74.6888504   71.06174469  67.94551849  65.86566925 ...
  65.64240265  67.67519379  71.18471527  74.64147949  65.0732193 ...
  70.24759674  74.37738037  83.25009155  78.96395111  75.06804657 ...
  71.66978455  68.87834167  67.49147034  68.69776154  71.70670319 ...
  74.99655914  78.52574158  70.14588165  74.20450592  78.30713654 ...
  87.92054749  83.43343353  79.29398346  75.62462616  72.56225586 ...
  70.24754333  69.87782288  72.3327179   75.44224548  78.82132721 ...
  82.4185257   74.12306976  78.16574097  82.24298859  92.70600891 ...
  88.05606842  83.70254517  79.77839661  76.4415741   73.87223053 ...
  72.25724792  73.06211853  75.97810364  79.19358063  82.65704346 ...
  86.31828308  78.10169983  82.13062286  86.18382263  97.56092834 ...
  92.78915405  88.25499725  84.09754181  80.48941803  77.64069366 ...
  75.7950058   76.60356903  79.64212799  82.95829773  86.50172424 ...
  90.22346497  82.0815506   86.09849548  90.12854004 102.4390717 ...
  97.58895111  92.91120911  88.54697418  84.67732239  81.53305054 ...
  79.40075684  80.16651154  83.32196808  86.73397064  90.35338593 ...
  94.13253021  86.06238556  90.06869507  94.07601929 107.2939911 ...
 102.4110489   97.63008118  93.09035492  88.97554016  85.52832031 ...
  83.06489563  83.74769592  87.01475525  90.51816559  94.21003723 ...
  98.04392242  90.04401398  94.04055023  98.02515411 112.0794525 ...
 107.2108383  102.3699112   97.69046021  93.353302    89.60459137 ...
  86.77742004  87.34380341  90.71762085  94.30846405  98.06967926 ...
 101.9561462   94.02619171  98.01340485 101.9748917  116.7499084 ...
 111.9439316  107.0887909  102.3095322   97.77908325  93.73925781 ...
  90.52791595  90.95154572  94.42769623  98.10240936 101.930397 ...
 105.8676376   98.00868988 101.9866104  105.9240875  121.2608948 ...
 116.5665665  111.7450027  106.9096451  102.2209091   97.9091568 ...
  94.30576324  94.56760406  98.14208221 101.8976669  105.7901764 ...
 101.9913177  105.9594955  125.5694885  121.0360489  116.2974548 ...
 111.4530334  106.646698   102.0908432   98.1000824   98.18865204 ...
 101.8579865  105.6917725  109.6469345  105.9738312  129.6347198 ...
 125.311142   120.7060242  115.9024582  111.0244598  106.2607498 ...
 101.8999176  101.8113861  105.5724945  109.4821854  133.4179688 ...
 129.3524933  124.9319534  120.221611   115.3226776  110.3954086 ...
 105.6942444  105.4324799  109.2826691  113.2664642  136.8609924 ...
 133.1229858  128.9382477  124.3753738  119.5105896  114.4716797 ...
 109.4720764  109.0485764  112.9856033  139.9302673  136.5107269 ...
 123.5584259  118.4669495  113.22258    112.6563492  139.4818115 ...
 122.3593063  116.9350967 ];


figure('DefaultAxesFontSize',19,'Position', [10 10 350 500])
z = CtLoc;
n=1000;
%Create regular grid across data space
[X,Y] = meshgrid(linspace(min(x),max(x),n), linspace(min(y),max(y),n));

%create contour plot
contourf(X,Y,griddata(x,y,z,X,Y))
c = colorbar;
c.Label.String = '$C_{T}^{*}$';
c.Label.Interpreter = 'latex';

ylabel('$y$ (m)','Interpreter','latex')
xlabel('$x$ (m)','Interpreter','latex')
pbaspect([1,2.75,1])


exportgraphics(gcf,'C:/Users/Marcus/Downloads/Fig15.eps','Resolution',1200)